angular.module("PaperUI.services").factory("util",["$filter","dateTime",function(e,t){function a(e,t,a){function r(e){return(e<10?"0":"")+e}if(e){for(var s="%1$T";e.toUpperCase().indexOf(s)!=-1;){var n=e.toUpperCase().indexOf(s),g="";if(e.length>n+s.length){switch(e[n+s.length]){case"H":g=r(t.getHours());break;case"l":var i=t.getHours()%12||12,o=t.getHours()<12?"AM":"PM";g=i+" "+o;break;case"I":var i=t.getHours()%12||12,o=t.getHours()<12?"AM":"PM";g=r(i)+" "+r(o);break;case"M":g=r(t.getMinutes());break;case"S":g=r(t.getSeconds());break;case"p":g=t.getHours()<12?"AM":"PM";break;case"R":g=r(t.getHours())+":"+r(t.getMinutes());break;case"T":g=r(t.getHours())+":"+r(t.getMinutes())+":"+r(t.getSeconds());break;case"r":var i=t.getHours()%12||12,o=t.getHours()<12?"AM":"PM";g=r(i)+":"+r(t.getMinutes())+":"+r(t.getSeconds())+" "+o;break;case"D":g=r(t.getMonth()+1)+"/"+r(t.getDate())+"/"+r(t.getFullYear());break;case"F":g=r(t.getFullYear())+"-"+r(t.getMonth()+1)+"-"+r(t.getDate());break;case"c":g=t;break;case"B":var c=a.getMonths(!1);c.length>0&&(g=c[t.getMonth()]);break;case"h":case"b":var u=a.getMonths(!0);u.length>0&&(g=u[t.getMonth()]);break;case"A":var l=a.getDaysOfWeek(!1);l.length>0&&(g=l[t.getDay()]);break;case"a":var p=a.getDaysOfWeek(!0);p.length>0&&(g=p[t.getDay()]);break;case"C":g=r(parseInt(t.getFullYear()/100));break;case"Y":g=t.getFullYear();break;case"y":g=r(parseInt(t.getFullYear()%100));break;case"m":g=r(t.getMonth()+1);break;case"d":g=r(t.getDate());break;case"e":g=r(t.getDate())}e=e.substr(0,n)+g+e.substr(n+s.length+1,e.length)}}return e}return""}return{getItemStateText:function(r){if("NULL"===r.state||"UNDEF"===r.state)return"-";if(null!=r.stateDescription&&r.stateDescription.options.length>0)for(var s=0;s<r.stateDescription.options.length;s++){var n=r.stateDescription.options[s];if(n.value===r.state)return n.label}var g=0===r.type.indexOf("Number")?parseFloat(r.state):r.state;if("DateTime"===r.type){var i,o=r.state.split(/[^0-9]/);return o.length>5&&(i=new Date(o[0],o[1]-1,o[2],o[3],o[4],o[5])),i?r.stateDescription&&r.stateDescription.pattern?a(r.stateDescription.pattern,i,t):e("date")(i,"dd.MM.yyyy HH:mm:ss"):"-"}if(r.stateDescription&&r.stateDescription.pattern){var c=r.unit;"%"===c&&(c="%%");var u=r.stateDescription.pattern.replace("%unit%",c);return sprintf(u,g)}return r.type&&"DIMMER"==r.type.toUpperCase()&&(g+=" %"),g}}}]);